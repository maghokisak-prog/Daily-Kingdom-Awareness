<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daily Kingdom Awareness â€” Bible Studies</title>
  <meta name="description" content="Bible study resources and guides. Add study links or upload PDFs (browser preview)." />
  <style>
    :root{--bg:#fbfaf9;--panel:#fff;--accent:#d4af37;--muted:#6b6b6b;--text:#111827;--radius:12px;--maxw:1100px}
    html{scroll-behavior:smooth}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial;background:linear-gradient(180deg,#f8f6f3,var(--bg));display:flex;justify-content:center;padding:28px;color:var(--text)}
    .wrap{width:100%;max-width:var(--maxw)}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
    nav a{margin-left:12px;color:var(--muted);text-decoration:none;font-weight:700}
    main{background:#fff;padding:22px;border-radius:12px;border:1px solid rgba(0,0,0,0.04)}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    .card{background:#fff;padding:14px;border-radius:10px;border:1px solid rgba(0,0,0,0.03)}
    .study{padding:10px;border-radius:10px;background:linear-gradient(180deg,#fbfbfb,#fff);margin-bottom:8px;border:1px solid rgba(0,0,0,0.02)}
    input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);margin-top:6px}
    .btn{background:var(--accent);color:#07120a;padding:10px 12px;border-radius:9px;border:0;font-weight:800;cursor:pointer}
    small{color:var(--muted)}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="font-weight:800">Daily Kingdom Awareness â€” Bible Studies</div>
      <nav>
        <a href="index.html">Home</a>
        <a href="ministry.html">Ministry</a>
        <a href="videos.html">Videos</a>
        <a href="contact.html">Contact</a>
        <a href="prayer.html">Prayers</a>
      </nav>
    </header>

    <main>
      <div class="grid">
        <div>
          <h2 style="margin-top:0">Bible Studies & Resources</h2>

          <!-- ðŸ”¹ Search Bar -->
          <div class="card" style="margin-bottom:14px">
            <input 
              type="text" 
              id="searchBar" 
              placeholder="Search studies by title, link, or file..." 
              style="padding:12px;font-size:1rem;border-radius:8px;width:100%;border:1px solid rgba(0,0,0,0.08)"
            />
          </div>
          
          <div id="studiesList" class="card" style="min-height:160px"></div>

          <!-- Login Form -->
          <section id="loginSection" style="margin-top:14px">
            <h3>Admin Login</h3>
            <div class="card">
              <label>Email</label>
              <input id="loginEmail" type="email" placeholder="Your admin email" />
              <label>Password</label>
              <input id="loginPass" type="password" placeholder="Your password" />
              <button id="loginBtn" class="btn" style="margin-top:10px">Login</button>
              <div id="loginStatus" style="margin-top:8px;color:var(--muted)"></div>
            </div>
          </section>

          <!-- Upload Form -->
          <section id="uploadSection" style="margin-top:14px;display:none">
            <h3>Add a Study (Link or Upload PDF)</h3>
            <div class="card">
              <label>Title</label>
              <input id="studyTitle" placeholder="Example: Living by Faith â€” Week 1" />
              <label>Link (Google Drive / PDF / external link)</label>
              <input id="studyLink" placeholder="https://..." />
              <div style="margin-top:8px"><small>Or upload a PDF (preview in browser session only)</small>
                <input id="studyFile" type="file" accept=".pdf" />
              </div>
              <button id="addStudy" class="btn" style="margin-top:10px">Add Study</button>
              <div id="studyStatus" style="margin-top:8px;color:var(--muted)"></div>
              <button id="logoutBtn" class="btn" style="margin-top:10px;background:#ccc;color:#000">Logout</button>
            </div>
          </section>
        </div>

<section style="margin:20px 0; padding:16px; background:#f0f4f8; border-radius:12px; max-width:600px; font-style:italic;">
  <strong>Bible Verse of the Day:</strong>
  <p id="verseOfDay" style="margin-top:8px; font-size:1.1rem; color:#333;"></p>
</section>
<script> verses = [
  "John 3:16 â€” For God so loved the world that He gave His only Son, that whoever believes in Him should not perish but have eternal life.",
  "Psalm 23:1 â€” The Lord is my shepherd; I shall not want.",
  "Romans 8:28 â€” And we know that for those who love God all things work together for good.",
  "Isaiah 41:10 â€” Fear not, for I am with you; be not dismayed, for I am your God.",
  "Philippians 4:13 â€” I can do all things through Him who strengthens me.",
];
function getVerseIndex() {
  const now = new Date();
  const start = new Date(now.getFullYear(), 0, 0);
  const diff = now - start;
  const oneDay = 1000 * 60 * 60 * 24;
  const dayOfYear = Math.floor(diff / oneDay);
  return dayOfYear % verses.length;
}
function showVerseOfTheDay() {
  const verseEl = document.getElementById("verseOfDay");
  const index = getVerseIndex();
  verseEl.textContent = verses[index];
}
showVerseOfTheDay();
</script>

        <aside>
          <div class="card">
            <strong>Online Bible</strong>
            <p style="color:var(--muted);margin-top:8px">
              We recommend: <a href="https://www.biblegateway.com" target="_blank" style="color:var(--muted)">Bible Gateway</a> or 
              <a href="https://www.youversion.com" target="_blank" style="color:var(--muted)">YouVersion</a>.
            </p>
          </div>
        </aside>
      </div>
    </main>
  </div>

<script>
  const STUDIES_KEY = 'dk_studies_v1';
  const ADMIN_EMAIL = 'maghokisak@gmail.com'; // Your email
  const ADMIN_PASS = 'G0745363724'; // password
  const LOGIN_KEY = 'dk_admin_logged';

  const studiesListEl = document.getElementById('studiesList');
  const loginSection = document.getElementById('loginSection');
  const uploadSection = document.getElementById('uploadSection');

  function escapeHtml(text){
    return (text||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[m]);
  }

  function loadStudies(){
    const raw = localStorage.getItem(STUDIES_KEY);
    const arr = raw ? JSON.parse(raw) : [];
    renderStudies(arr);
  }

  function renderStudies(arr){
    if(!arr.length){
      studiesListEl.innerHTML = '<div style="color:#6b6b6b">Not yet _ Add one using the admin panel.</div>';
      return;
    }
    const isAdmin = localStorage.getItem(LOGIN_KEY) === 'true';
    studiesListEl.innerHTML = arr.map((s, i) => `
      <div class="study">
        <strong>${escapeHtml(s.title)}</strong>
        <div style="color:#6b6b6b;font-size:14px;margin-top:8px">
          ${s.link ? `<a href="${s.link}" target="_blank" style="color:#6b6b6b">Open Link</a>` : ''}
          ${s.fileName ? `<br/><a href="${s.fileUrl}" download="${s.fileName}" style="color:#6b6b6b">Download: ${s.fileName}</a>` : ''}
        </div>
        ${isAdmin ? `<button class="btn" style="margin-top:8px;background:#e74c3c;color:#fff" onclick="deleteStudy(${i})">Delete</button>` : ''}
      </div>
    `).join('');
  }

  function deleteStudy(index){
    if(!confirm("Are you sure you want to delete this study?")) return;
    let arr = JSON.parse(localStorage.getItem(STUDIES_KEY) || '[]');
    arr.splice(index, 1);
    localStorage.setItem(STUDIES_KEY, JSON.stringify(arr));
    loadStudies();
  }

  document.getElementById('loginBtn').addEventListener('click', ()=>{
    const email = document.getElementById('loginEmail').value.trim();
    const pass = document.getElementById('loginPass').value.trim();
    if(email === ADMIN_EMAIL && pass === ADMIN_PASS){
      localStorage.setItem(LOGIN_KEY, 'true');
      showUploadSection();
      loadStudies();
    } else {
      document.getElementById('loginStatus').textContent = 'Invalid email or password.';
    }
  });

  document.getElementById('logoutBtn').addEventListener('click', ()=>{
    localStorage.removeItem(LOGIN_KEY);
    showLoginSection();
    loadStudies();
  });

  document.getElementById('addStudy').addEventListener('click', ()=>{
    const title = document.getElementById('studyTitle').value.trim();
    const link = document.getElementById('studyLink').value.trim();
    const fileInput = document.getElementById('studyFile');
    if(!title){
      document.getElementById('studyStatus').textContent = 'Please enter a title.';
      return;
    }
    let arr = JSON.parse(localStorage.getItem(STUDIES_KEY) || '[]');
    let entry = {title, link: link || null, fileName: null, fileUrl: null, created: new Date().toISOString()};
    if(fileInput.files && fileInput.files[0]){
      const f = fileInput.files[0];
      entry.fileName = f.name;
      entry.fileUrl = URL.createObjectURL(f); // session preview only
    }
    arr.unshift(entry);
    localStorage.setItem(STUDIES_KEY, JSON.stringify(arr));
    document.getElementById('studyStatus').textContent = 'Study added (saved to your browser).';
    document.getElementById('studyTitle').value='';
    document.getElementById('studyLink').value='';
    fileInput.value='';
    loadStudies();
  });

  function showUploadSection(){
    loginSection.style.display = 'none';
    uploadSection.style.display = 'block';
  }

  function showLoginSection(){
    loginSection.style.display = 'block';
    uploadSection.style.display = 'none';
  }

  // ðŸ”¹ Enhanced Search Function
  function filterStudies() {
    const query = document.getElementById('searchBar').value.toLowerCase();
    const raw = localStorage.getItem(STUDIES_KEY);
    const arr = raw ? JSON.parse(raw) : [];

    const filtered = arr.filter(s => {
      return (
        (s.title && s.title.toLowerCase().includes(query)) ||
        (s.link && s.link.toLowerCase().includes(query)) ||
        (s.fileName && s.fileName.toLowerCase().includes(query))
      );
    });

    renderStudies(filtered);
  }

  // Attach search listener
  document.getElementById('searchBar').addEventListener('input', filterStudies);

  // Initial load
  if(localStorage.getItem(LOGIN_KEY) === 'true'){
    showUploadSection();
  } else {
    showLoginSection();
  }
  loadStudies();
</script>

</body>
</html>

